<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Watch Finder ‚Äî Example (Dark)</title>
  <meta name="color-scheme" content="dark light">
  <style>

    :root{
      --bg:#0b0f12;
      --panel:#0f1417;
      --muted:#9aa4ad;
      --text:#e6eef3;
      --accent:#0ea5c9;
      --accent-2:#6dd3ff;
      --glass: rgba(255,255,255,0.03);
      --card-shadow: 0 8px 30px rgba(2,6,12,0.6);
      --radius:12px;
      --gap:1rem;
      --max-w:1200px;
      --break-md:900px;
      --break-sm:640px;
      --focus: 3px solid rgba(14,165,201,0.18);
      --transition: 220ms cubic-bezier(.2,.9,.3,1);
      --reader: 14px/1.4 "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:radial-gradient(1200px 600px at 10% 10%, rgba(14,165,201,0.03), transparent 8%),
                 linear-gradient(180deg,#071014 0%, var(--bg) 50%);
      color:var(--text);
      font:var(--reader);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    .container{max-width:var(--max-w);margin:0 auto;padding:1rem}
    a{color:inherit;text-decoration:none}
    button{font:inherit}

    .site-header{
      border-bottom:1px solid rgba(255,255,255,0.03);
      background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);
      position:sticky; top:0; z-index:50; backdrop-filter: blur(4px);
    }
    .header-inner{display:flex;align-items:center;gap:1rem;justify-content:space-between;padding:.75rem 0}
    .brand{font-weight:700;letter-spacing:1px}
    .main-nav ul{display:flex;gap:1rem;list-style:none;padding:0;margin:0}
    .main-nav a{padding:.45rem .6rem;border-radius:8px;color:var(--muted)}
    .main-nav a.active, .main-nav a:hover{color:var(--accent-2);background:rgba(255,255,255,0.02)}

    .header-actions{display:flex;gap:.5rem;align-items:center}
    .search-toggle{background:transparent;border:1px solid rgba(255,255,255,0.04); padding:.45rem .6rem;border-radius:10px;color:var(--muted);cursor:pointer}
    .search-toggle:focus{outline:var(--focus)}
    .region-select{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:.4rem;border-radius:10px;color:var(--muted)}

    main{padding:1.25rem 0}
    .breadcrumbs{font-size:.9rem;color:var(--muted);margin-bottom:.5rem}
    .page-title{font-size:2rem;margin:0 0 1rem 0;letter-spacing:-0.2px}

    .finder-grid{display:grid;grid-template-columns:300px 1fr;gap:var(--gap);align-items:start}
    @media (max-width:var(--break-md)){ .finder-grid{grid-template-columns:1fr} }

    .filters{
      background:linear-gradient(180deg, rgba(255,255,255,0.012), transparent);
      border:1px solid rgba(255,255,255,0.03);
      padding:1rem;border-radius:var(--radius);
      position:relative;
    }
    @media (min-width:901px){
      .filters{position:sticky;top:1rem;align-self:start}
    }
    .filters h3{margin:.25rem 0 .5rem 0;font-size:1rem;color:var(--text)}
    .filters .controls{display:flex;gap:.5rem;align-items:center;margin-bottom:.75rem}
    .clear-filters{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:.4rem .6rem;border-radius:10px;color:var(--muted);cursor:pointer}
    .clear-filters:focus{outline:var(--focus)}

    .filter-group{border-top:1px solid rgba(255,255,255,0.02);padding-top:.6rem;margin-top:.6rem}
    .filter-toggle{
      display:flex;justify-content:space-between;align-items:center;width:100%;
      background:transparent;border:0;padding:.35rem 0;color:var(--accent-2);font-weight:600;cursor:pointer;
    }
    .filter-body{margin-top:.5rem;padding-left:.25rem;display:block}
    .filter-body label{
      display:flex;align-items:center;gap:.6rem;padding:.35rem 0;color:var(--muted);cursor:pointer;
    }
    .filter-body input[type="checkbox"]{width:16px;height:16px;border-radius:4px}
    .count-badge{margin-left:auto;color:var(--muted);font-size:.85rem}

    .results{
      min-height:200px;
      background:linear-gradient(180deg, rgba(255,255,255,0.006), transparent);
      border:1px solid rgba(255,255,255,0.03);
      padding:1rem;border-radius:var(--radius);
    }
    .results-controls{
      display:flex;gap:.75rem;align-items:center;justify-content:space-between;margin-bottom:1rem;
      flex-wrap:wrap;
    }
    .controls-left{display:flex;gap:.6rem;align-items:center}
    .view-count{display:flex;align-items:center;gap:.4rem;color:var(--muted)}
    .search-input{padding:.45rem .6rem;border-radius:10px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:var(--text)}
    select#sort{padding:.45rem .6rem;border-radius:10px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:var(--text)}
    .result-meta{color:var(--muted);font-size:.95rem;margin-bottom:.5rem}
    
    .product-grid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:1rem;
    }
    @media (max-width:900px){ .product-grid{grid-template-columns: repeat(2, 1fr)} }
    @media (max-width:600px){ .product-grid{grid-template-columns: 1fr} }

    .product-card{
      background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);
      border-radius:12px;overflow:hidden;box-shadow:var(--card-shadow);display:flex;flex-direction:column;transition:transform var(--transition), box-shadow var(--transition);
      border:1px solid rgba(255,255,255,0.02);
    }
    .product-card:focus-within, .product-card:hover{ transform: translateY(-6px); box-shadow: 0 20px 50px rgba(2,6,12,0.7) }
    .thumb{display:block;position:relative;aspect-ratio:4/3; overflow:hidden}
    .thumb img{width:100%;height:100%;object-fit:cover;display:block;filter:contrast(1.03) saturate(1.05)}
    .meta{padding:.75rem .85rem .9rem .85rem;display:flex;flex-direction:column;gap:.25rem}
    .meta .label{font-size:.8rem;color:var(--muted)}
    .meta .title{font-weight:600;letter-spacing:-0.2px}
    .meta .price{margin-top:auto;font-weight:700;color:var(--accent-2)}

    .card-actions{display:flex;gap:.5rem;padding:.6rem;border-top:1px solid rgba(255,255,255,0.02);background:linear-gradient(180deg, rgba(255,255,255,0.005), transparent)}
    .btn{padding:.45rem .6rem;border-radius:10px;border:0;background:transparent;color:var(--accent-2);cursor:pointer}
    .btn:focus{outline:var(--focus)}

    .pagination{display:flex;gap:.6rem;align-items:center;justify-content:center;padding-top:1rem}
    .page-btn{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:.45rem .65rem;border-radius:10px;color:var(--muted);cursor:pointer}
    .page-info{color:var(--muted)}

    .empty{padding:2rem;text-align:center;color:var(--muted)}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

    :focus{outline-offset:2px}
    a:focus, button:focus, input:focus, select:focus{outline:var(--focus);border-radius:8px}

    @media (max-width:640px){
      .filters{order:2}
      .results{order:1}
      .filter-body{display:none}
      .filter-toggle[aria-expanded="true"] + .filter-body{display:block}
    }

    .fade-up{transform-origin:center;opacity:0;transform:translateY(6px)}
    .fade-up.show{opacity:1;transform:none;transition:opacity 360ms var(--transition), transform 360ms var(--transition)}
    footer.site-footer{padding:1.25rem 0;color:var(--muted);text-align:center}
  </style>
</head>
<body>
  <header class="site-header" role="banner">
    <div class="container header-inner">
     <a class="brand" href="/" aria-label="Seiko Watch Home">SEIKO WATCH</a>
      <nav class="main-nav" aria-label="Main navigation">
        <ul>
          <li><a href="#collections">Collections</a></li>
          <li><a href="#finder" class="active">Watch Finder</a></li>
          <li><a href="#company">Company</a></li>
        </ul>
      </nav>

      <div class="header-actions" role="group" aria-label="Header actions">
        <button class="search-toggle" aria-expanded="false" aria-controls="global-search">üîç Search</button>
        <select class="region-select" aria-label="Select Region">
          <option value="no">Norge</option>
          <option value="se">Sverige</option>
          <option value="fi">Suomi</option>
        </select>
      </div>
    </div>
  </header>

  <main class="container page-watchfinder" id="finder" role="main">

    <h1 class="page-title">Watch Finder</h1>

    <div class="finder-grid" aria-live="polite">
      
      <aside class="filters" id="filters" aria-label="Filters">
        <div class="controls">
          <h3>Refine results</h3>
          <div style="margin-left:auto">
            <button id="clear-all" class="clear-filters" title="Clear all filters">Clear</button>
          </div>
        </div>

        <form id="filters-form" aria-describedby="filters-desc">
          <div id="filters-desc" class="sr-only">Use these filters to narrow watch results. Counts update live.</div>

          <div style="margin-bottom:.65rem">
            <input id="q" class="search-input" placeholder="Search model or collection" aria-label="Search models" />
          </div>

          <div class="filter-group" data-filter="category">
            <button type="button" class="filter-toggle" aria-expanded="true">Category <span class="count-badge" data-group-count="category"></span></button>
            <div class="filter-body" role="group" aria-label="Category options">
              <label><input type="checkbox" name="category" value="New"> New <span class="count-badge" data-count-for="category:New"></span></label>
              <label><input type="checkbox" name="category" value="Limited"> Limited Edition <span class="count-badge" data-count-for="category:Limited"></span></label>
              <label><input type="checkbox" name="category" value="Divers"> Divers <span class="count-badge" data-count-for="category:Divers"></span></label>
              <label><input type="checkbox" name="category" value="Presage"> Presage <span class="count-badge" data-count-for="category:Presage"></span></label>
            </div>
          </div>

          <div class="filter-group" data-filter="caseMaterial">
            <button type="button" class="filter-toggle" aria-expanded="true">Case material <span class="count-badge" data-group-count="caseMaterial"></span></button>
            <div class="filter-body" role="group" aria-label="Case material options">
              <label><input type="checkbox" name="caseMaterial" value="Stainless steel"> Stainless steel <span class="count-badge" data-count-for="caseMaterial:Stainless steel"></span></label>
              <label><input type="checkbox" name="caseMaterial" value="Titanium"> Titanium <span class="count-badge" data-count-for="caseMaterial:Titanium"></span></label>
              <label><input type="checkbox" name="caseMaterial" value="Ceramic"> Ceramic <span class="count-badge" data-count-for="caseMaterial:Ceramic"></span></label>
            </div>
          </div>

          <div class="filter-group" data-filter="bandMaterial">
            <button type="button" class="filter-toggle" aria-expanded="true">Band material <span class="count-badge" data-group-count="bandMaterial"></span></button>
            <div class="filter-body" role="group" aria-label="Band material options">
              <label><input type="checkbox" name="bandMaterial" value="Bracelet"> Bracelet <span class="count-badge" data-count-for="bandMaterial:Bracelet"></span></label>
              <label><input type="checkbox" name="bandMaterial" value="Leather"> Leather <span class="count-badge" data-count-for="bandMaterial:Leather"></span></label>
              <label><input type="checkbox" name="bandMaterial" value="Rubber"> Rubber <span class="count-badge" data-count-for="bandMaterial:Rubber"></span></label>
            </div>
          </div>

          <div class="filter-group" data-filter="movement">
            <button type="button" class="filter-toggle" aria-expanded="true">Movement <span class="count-badge" data-group-count="movement"></span></button>
            <div class="filter-body" role="group" aria-label="Movement options">
              <label><input type="checkbox" name="movement" value="Automatic"> Automatic <span class="count-badge" data-count-for="movement:Automatic"></span></label>
              <label><input type="checkbox" name="movement" value="Quartz"> Quartz <span class="count-badge" data-count-for="movement:Quartz"></span></label>
              <label><input type="checkbox" name="movement" value="Spring Drive"> Spring Drive <span class="count-badge" data-count-for="movement:Spring Drive"></span></label>
            </div>
          </div>

          <div class="filter-group" data-filter="caseSize">
            <button type="button" class="filter-toggle" aria-expanded="true">Case size <span class="count-badge" data-group-count="caseSize"></span></button>
            <div class="filter-body" role="group" aria-label="Case size options">
              <label><input type="checkbox" name="caseSize" value="36"> 36 mm <span class="count-badge" data-count-for="caseSize:36"></span></label>
              <label><input type="checkbox" name="caseSize" value="39"> 39 mm <span class="count-badge" data-count-for="caseSize:39"></span></label>
              <label><input type="checkbox" name="caseSize" value="42"> 42 mm <span class="count-badge" data-count-for="caseSize:42"></span></label>
              <label><input type="checkbox" name="caseSize" value="44"> 44 mm <span class="count-badge" data-count-for="caseSize:44"></span></label>
            </div>
          </div>

        </form>
      </aside>

      <section class="results" aria-live="polite">
        <div class="results-controls">
          <div class="controls-left">
            <div class="view-count" aria-hidden="true"><strong id="results-count">0</strong> results</div>
            <div style="margin-left:0.6rem">
              <label for="sort" class="sr-only">Sort by</label>
              <select id="sort" name="sort" aria-label="Sort results">
                <option value="relevance">Recommended</option>
                <option value="new">New</option>
                <option value="priceasc">Price: Low to high</option>
                <option value="pricedesc">Price: High to low</option>
              </select>
            </div>
          </div>

          <div>
            <label for="per-page" class="sr-only">Results per page</label>
            <select id="per-page" aria-label="Results per page">
              <option value="9">9 / page</option>
              <option value="12">12 / page</option>
              <option value="18">18 / page</option>
            </select>
          </div>
        </div>

        <div id="status" class="result-meta" aria-live="polite"></div>

        <div id="product-grid" class="product-grid" role="list" aria-label="Product results">
        </div>

        <nav class="pagination" aria-label="Pagination">
          <button id="prev-page" class="page-btn" aria-label="Previous page">Prev</button>
          <div class="page-info" aria-live="polite"><span id="page-info">Page 1</span></div>
          <button id="next-page" class="page-btn" aria-label="Next page">Next</button>
        </nav>
      </section>
    </div>
  </main>

  <footer class="site-footer" role="contentinfo">
    <div class="container">¬© 2025 Seiko Watch Corporation ‚Äî demo</div>
  </footer>
  <script>
  (function(){
    'use strict';
    
    const PRODUCTS = [
      { id: "S1", name: "Prospex Diver 200m", collection:"Prospex", category:"Divers", caseMaterial:"Stainless steel", bandMaterial:"Bracelet", movement:"Automatic", caseSize:44, price:760, image:svgDataUrl("Prospex Diver 200m","#0b4a6f","#071014"), url:"#"},
      { id: "S2", name: "Presage Cocktail Time", collection:"Presage", category:"Presage", caseMaterial:"Stainless steel", bandMaterial:"Leather", movement:"Automatic", caseSize:39, price:450, image:svgDataUrl("Presage Cocktail","#6a3b7a"), url:"#"},
      { id: "S3", name: "Astron GPS Solar", collection:"Astron", category:"New", caseMaterial:"Titanium", bandMaterial:"Bracelet", movement:"Quartz", caseSize:42, price:2200, image:svgDataUrl("Astron GPS","#0a2938"), url:"#"},
      { id: "S4", name: "Prospex Turtle", collection:"Prospex", category:"Divers", caseMaterial:"Stainless steel", bandMaterial:"Rubber", movement:"Automatic", caseSize:44, price:520, image:svgDataUrl("Prospex Turtle","#1f3f4a"), url:"#"},
      { id: "S5", name: "Presage Enamel", collection:"Presage", category:"Limited", caseMaterial:"Stainless steel", bandMaterial:"Leather", movement:"Automatic", caseSize:39, price:1250, image:svgDataUrl("Presage Enamel","#4a2b2b"), url:"#"},
      { id: "S6", name: "Seiko 5 Sports", collection:"Seiko 5", category:"New", caseMaterial:"Stainless steel", bandMaterial:"Bracelet", movement:"Automatic", caseSize:42, price:295, image:svgDataUrl("Seiko 5 Sports","#2b5f3c"), url:"#"},
      { id: "S7", name: "Grand Seiko Elegance", collection:"Grand Seiko", category:"Limited", caseMaterial:"Ceramic", bandMaterial:"Leather", movement:"Spring Drive", caseSize:39, price:6800, image:svgDataUrl("Grand Seiko","#2b2b5f"), url:"#"},
      { id: "S8", name: "Prospex Solar Chrono", collection:"Prospex", category:"New", caseMaterial:"Titanium", bandMaterial:"Bracelet", movement:"Quartz", caseSize:44, price:620, image:svgDataUrl("Prospex Chrono","#123c4a"), url:"#"},
      { id: "S9", name: "Diver Classic 36", collection:"Diver Classic", category:"Divers", caseMaterial:"Stainless steel", bandMaterial:"Bracelet", movement:"Automatic", caseSize:36, price:410, image:svgDataUrl("Diver Classic","#234b6b"), url:"#"},
      { id: "S10", name: "Elegance Slim 39", collection:"Elegance", category:"Presage", caseMaterial:"Stainless steel", bandMaterial:"Leather", movement:"Quartz", caseSize:39, price:380, image:svgDataUrl("Elegance Slim","#4b2b3a"), url:"#"},
      { id: "S11", name: "Limited Edition Blue", collection:"Limited", category:"Limited", caseMaterial:"Ceramic", bandMaterial:"Leather", movement:"Automatic", caseSize:42, price:2890, image:svgDataUrl("Limited Blue","#0a2b4a"), url:"#"},
      { id: "S12", name: "Titanium Field 42", collection:"Field", category:"New", caseMaterial:"Titanium", bandMaterial:"Rubber", movement:"Quartz", caseSize:42, price:520, image:svgDataUrl("Titanium Field","#2a3f2b"), url:"#"},
      { id: "S13", name: "Presage White Dial", collection:"Presage", category:"Presage", caseMaterial:"Stainless steel", bandMaterial:"Leather", movement:"Automatic", caseSize:39, price:720, image:svgDataUrl("Presage White","#c4c4c4"), url:"#"},
      { id: "S14", name: "Seiko Minimal 36", collection:"Seiko 5", category:"New", caseMaterial:"Stainless steel", bandMaterial:"Bracelet", movement:"Quartz", caseSize:36, price:180, image:svgDataUrl("Minimal 36","#556b5f"), url:"#"},
      { id: "S15", name: "Deep Blue 44", collection:"Prospex", category:"Divers", caseMaterial:"Stainless steel", bandMaterial:"Rubber", movement:"Automatic", caseSize:44, price:980, image:svgDataUrl("Deep Blue","#023e6a"), url:"#"}
    ];

    function svgDataUrl(text, bg="#222", fg="#fff"){
      const w=800,h=600,esc = s => String(s).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;");
      const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='${w}' height='${h}' viewBox='0 0 ${w} ${h}'>
        <rect width='100%' height='100%' fill='${bg}'/>
        <g transform='translate(32,40)'>
          <text x='0' y='56' font-family='Inter, system-ui' font-weight='700' font-size='48' fill='${fg}'>${esc(text)}</text>
        </g>
      </svg>`;
      return 'data:image/svg+xml;utf8,' + encodeURIComponent(svg);
    }

    function debounce(fn, ms=180){
      let t;
      return (...args)=>{ clearTimeout(t); t = setTimeout(()=>fn(...args), ms); };
    }

    let state = {
      all: PRODUCTS.slice(),
      filtered: [],
      page: 1,
      perPage: 9,
      sort: 'relevance',
      q: ''
    };

    const DOM = {
      grid: document.getElementById('product-grid'),
      form: document.getElementById('filters-form'),
      resultsCount: document.getElementById('results-count'),
      status: document.getElementById('status'),
      sort: document.getElementById('sort'),
      perPage: document.getElementById('per-page'),
      q: document.getElementById('q'),
      pageInfo: document.getElementById('page-info'),
      prevBtn: document.getElementById('prev-page'),
      nextBtn: document.getElementById('next-page'),
      clearAll: document.getElementById('clear-all')
    };

    function init(){
      bindUI();
      readURL();
      applyFilters();
      updateAllCounts();
      document.querySelectorAll('.filter-toggle').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const expanded = btn.getAttribute('aria-expanded') === 'true';
          btn.setAttribute('aria-expanded', String(!expanded));
          const body = btn.nextElementSibling;
          if(body) body.style.display = !expanded ? 'block' : 'none';
        });
      });
    }

    function bindUI(){
      DOM.form.addEventListener('change', debounce(e=>{
        if(e.target && e.target.name){
          state.page = 1;
          applyFilters();
        }
      }, 150));

      DOM.sort.addEventListener('change', ()=>{ state.sort = DOM.sort.value; applyFilters(); });
      DOM.perPage.addEventListener('change', ()=>{ state.perPage = parseInt(DOM.perPage.value,10) || 9; state.page = 1; render(); });
      DOM.q.addEventListener('input', debounce((e)=>{ state.q = e.target.value.trim(); state.page = 1; applyFilters(); },220));

      DOM.prevBtn.addEventListener('click', ()=>{ if(state.page>1){ state.page--; render(); scrollToTop(); }});
      DOM.nextBtn.addEventListener('click', ()=>{ const max = Math.ceil(state.filtered.length/state.perPage); if(state.page<max){ state.page++; render(); scrollToTop(); }});
      DOM.clearAll.addEventListener('click', clearAllFilters);

      document.querySelector('.search-toggle').addEventListener('click', ()=>{
        const s = document.getElementById('q');
        s.focus();
        s.select();
      });

      DOM.grid.addEventListener('keydown', (e)=>{
        if(e.key === 'Enter'){
          const a = e.target.closest('a');
          if(a) a.click();
        }
      });

      window.addEventListener('popstate', (e)=>{ readURL(); applyFilters(false); });
    }

    function getActiveFilters(){
      const fd = new FormData(DOM.form);
      const map = {};
      for(const [k,v] of fd.entries()){
        if(!map[k]) map[k]=new Set();
        map[k].add(v);
      }
      Object.keys(map).forEach(k=>map[k]=Array.from(map[k]));
      return map;
    }

    function applyFilters(pushURL = true){
      const filters = getActiveFilters();
      const q = state.q && state.q.toLowerCase();
      state.filtered = state.all.filter(p=>{
        if(q){
          const composite = `${p.name} ${p.collection} ${p.category}`.toLowerCase();
          if(!composite.includes(q)) return false;
        }
        for(const key in filters){
          if(!filters[key].length) continue;
          const val = filters[key];
          if(!val.some(v => String(p[key]) === String(v))) return false;
        }
        return true;
      });

      switch(state.sort){
        case 'priceasc': state.filtered.sort((a,b)=>a.price - b.price); break;
        case 'pricedesc': state.filtered.sort((a,b)=>b.price - a.price); break;
        case 'new': state.filtered.sort((a,b)=> (a.category=== 'New' ? -1 : 1)); break;
        default: 
          state.filtered.sort((a,b)=>a.name.localeCompare(b.name));
      }

      updateAllCounts();
      state.page = Math.min(state.page, Math.max(1, Math.ceil(state.filtered.length / state.perPage)));
      render();
      if(pushURL) pushStateToURL();
    }

    function render(){
      DOM.grid.innerHTML = '';
      const total = state.filtered.length;
      DOM.resultsCount.textContent = total;
      DOM.status.textContent = total ? `${total} watches matching` : 'No watches match your filters. Try clearing filters.';
      const start = (state.page-1)*state.perPage;
      const end = start + state.perPage;
      const pageSlice = state.filtered.slice(start, end);

      if(pageSlice.length === 0){
        DOM.grid.innerHTML = `<div class="empty" role="status">No results</div>`;
      } else {
        const frag = document.createDocumentFragment();
        pageSlice.forEach(p => {
          const item = document.createElement('article');
          item.setAttribute('role','listitem');
          item.className = 'product-card fade-up show';
          item.innerHTML = `
            <a class="thumb" href="${p.url}" aria-label="${p.name}">
              <img src="${p.image}" alt="${p.name}" loading="lazy" width="800" height="600">
            </a>
            <div class="meta">
              <div class="label">${escapeHtml(p.collection)} ‚Ä¢ ${escapeHtml(p.category)}</div>
              <div class="title">${escapeHtml(p.name)}</div>
              <div class="price">${formatPrice(p.price)}</div>
            </div>
            <div class="card-actions">
              <button class="btn" type="button" aria-label="Quick view ${escapeHtml(p.name)}">Quick view</button>
              <a class="btn" href="${p.url}" aria-label="Open ${escapeHtml(p.name)}">View</a>
            </div>`;
          frag.appendChild(item);
        });
        DOM.grid.appendChild(frag);
      }

      const pages = Math.max(1, Math.ceil(total / state.perPage));
      DOM.pageInfo.textContent = `Page ${state.page} of ${pages}`;
      DOM.prevBtn.disabled = state.page <= 1;
      DOM.nextBtn.disabled = state.page >= pages;
    }

    function updateAllCounts(){

      const active = getActiveFilters();
      const q = state.q && state.q.toLowerCase();

      
        return state.all.filter(p=>{
         
          if(q){
            const composite = `${p.name} ${p.collection} ${p.category}`.toLowerCase();
            if(!composite.includes(q)) return false;
          }
          for(const k in active){
            if(k === key) continue; 
            if(active[k].length && !active[k].includes(String(p[k]))) return false;
          }
        
          return String(p[key]) === String(value);
        }).length;
      }

    
      document.querySelectorAll('[data-count-for]').forEach(el=>{
        const keyval = el.getAttribute('data-count-for'); 
        if(!keyval) return;
        const [k,v] = keyval.split(':');
        const c = countFor(k, v);
        el.textContent = c ? `(${c})` : '(0)';
      });

      document.querySelectorAll('[data-group-count]').forEach(el=>{
        const key = el.getAttribute('data-group-count');
        const counts = Array.from(document.querySelectorAll(`[data-count-for^="${key}:"]`)).map(x=>{
          const txt = x.textContent || '';
          const num = parseInt(txt.replace(/[^\d]/g,''),10) || 0;
          return num;
        });
        const total = counts.reduce((s,n)=>s+n,0);
        el.textContent = total ? `(${total})` : '(0)';
      });
    }

 
    function clearAllFilters(){
   
      DOM.form.querySelectorAll('input[type="checkbox"]').forEach(cb=>cb.checked=false);
      DOM.q.value = '';
      state.q = '';
      state.page = 1;
      applyFilters();

      DOM.status.textContent = 'Filters cleared.';
      updateAllCounts();
    }

    function pushStateToURL(){
      const params = new URLSearchParams();

      const fd = new FormData(DOM.form);
      for(const [k,v] of fd.entries()){
        params.append(k,v);
      }
      if(state.q) params.set('q', state.q);
      if(state.sort && state.sort !== 'relevance') params.set('sort', state.sort);
      if(state.perPage && state.perPage !== 9) params.set('per', state.perPage);
      if(state.page && state.page > 1) params.set('page', state.page);
      const url = `${location.pathname}?${params.toString()}`;
      history.replaceState({}, '', url);
    }

    function readURL(){
      const params = new URLSearchParams(location.search);

      DOM.form.querySelectorAll('input[type="checkbox"]').forEach(cb=>{
        const key = cb.name;
        const vals = params.getAll(key);
        cb.checked = vals.includes(cb.value);
      });

      const q = params.get('q') || '';
      DOM.q.value = q;
      state.q = q;

      const sort = params.get('sort') || 'relevance';
      DOM.sort.value = sort;
      state.sort = sort;

      const per = parseInt(params.get('per'),10) || 9;
      DOM.perPage.value = per;
      state.perPage = per;

      const page = parseInt(params.get('page'),10) || 1;
      state.page = page;
    }


    function formatPrice(n){ return n ? '‚Ç¨' + n.toLocaleString() : '‚Äî'; }
    function escapeHtml(s){ return String(s).replace(/[&<>"']/g, c=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[c])); }
    function scrollToTop(){ window.scrollTo({top: document.querySelector('.results').offsetTop - 20, behavior:'smooth'}); }

    init();

  })();
  </script>
</body>
</html>
